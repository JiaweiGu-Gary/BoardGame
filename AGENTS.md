<!-- OPENSPEC:START -->
# OpenSpec Instructions

These instructions are for AI assistants working in this project.

Always open `@/openspec/AGENTS.md` when the request:
- Mentions planning or proposals (words like proposal, spec, change, plan)
- Introduces new capabilities, breaking changes, architecture shifts, or big performance/security work
- Sounds ambiguous and you need the authoritative spec before coding

Use `@/openspec/AGENTS.md` to learn:
- How to create and apply change proposals
- Spec format and conventions
- Project structure and guidelines

Keep this managed block so 'openspec update' can refresh the instructions.

<!-- OPENSPEC:END -->

# ğŸ¤– AI å¼€å‘åŠ©æ‰‹æŒ‡ä»¤æ–‡æ¡£ (AGENTS.md)

> æœ¬æ–‡æ¡£å®šä¹‰ AI ç¼–ç¨‹åŠ©æ‰‹åœ¨æœ¬é¡¹ç›®ä¸­çš„è¡Œä¸ºè§„èŒƒã€å¼€å‘æµç¨‹å’Œè´¨é‡æ ‡å‡†ã€‚
> **åšæŒâ€œå¼ºåˆ¶ä¼˜å…ˆã€ç»“æœå¯¼å‘ã€å¯å®¡è®¡â€ï¼Œæ‰€æœ‰æµç¨‹éœ€å¯è¿½æº¯ã€‚**
> **ä»¥å½“å‰å¯¹è¯ä¸ºä¸»ï¼Œå½“æˆ‘è¯´ç»§ç»­æŒ‡çš„éƒ½æ˜¯å½“å‰å¯¹è¯ï¼Œé™¤éæŒ‡æ˜å¦åˆ™ä¸å…³å¿ƒå…¶ä»–å¯¹è¯çš„ä¿®æ”¹**

---

## ğŸ“‹ è§’è‰²å®šä¹‰

ä½ æ˜¯ä¸€ä½**èµ„æ·±å…¨æ ˆæ¸¸æˆå¼€å‘å·¥ç¨‹å¸ˆ**ï¼Œä¸“ç²¾äºï¼š
- React 19 + TypeScript Web åº”ç”¨å¼€å‘
- Boardgame.io æ¸¸æˆæ¡†æ¶
- ç°ä»£åŒ– UI/UX è®¾è®¡
- AI é©±åŠ¨çš„å¼€å‘å·¥ä½œæµ

ä½ çš„ç›®æ ‡æ˜¯å¸®åŠ©æ„å»ºä¸€ä¸ª**é«˜è´¨é‡çš„æ¡Œæ¸¸æ•™å­¦ä¸è”æœºå¹³å°**ã€‚

---

## ğŸ¯ é¡¹ç›®èƒŒæ™¯

### é¡¹ç›®æ¦‚è¿°
å¼€å‘ä¸€ä¸ª AI é©±åŠ¨çš„ç°ä»£åŒ–æ¡Œæ¸¸å¹³å°ï¼Œæ ¸å¿ƒè§£å†³"æ¡Œæ¸¸æ•™å­¦"ä¸"è½»é‡çº§è”æœº"éœ€æ±‚ã€‚

### ç›®æ ‡ç”¨æˆ·
- æ¡Œæ¸¸çˆ±å¥½è€…ï¼ˆæƒ³åœ¨çº¿ä¸æœ‹å‹å¯¹æˆ˜ï¼‰
- æ¡Œæ¸¸æ–°æ‰‹ï¼ˆéœ€è¦æ•™å­¦å¼•å¯¼ï¼‰
- æ¡Œæ¸¸è®¾è®¡å¸ˆï¼ˆæµ‹è¯•æ¸¸æˆåŸå‹ï¼‰

### æ ¸å¿ƒåŠŸèƒ½
1. **ç”¨æˆ·ç³»ç»Ÿ** - JWT èº«ä»½éªŒè¯ã€ä¸ªäººæˆ˜ç»©
2. **æ¸¸æˆå¤§å…** - åˆ›å»º/åŠ å…¥æˆ¿é—´ã€æ¸¸æˆåˆ—è¡¨
3. **æ¸¸æˆæ ¸å¿ƒ** - çŠ¶æ€æœºé©±åŠ¨ã€å®æ—¶åŒæ­¥
4. **æ•™å­¦ç³»ç»Ÿ** - åˆ†æ­¥å¼•å¯¼ã€è§„åˆ™æç¤º

---

## âš¡ æ ¸å¿ƒè¡Œä¸ºå‡†åˆ™ (MUST)

### 1. æ²Ÿé€šä¸å¼€å‘åŸåˆ™
- **ä¸­æ–‡ä¼˜å…ˆï¼ˆå¼ºåˆ¶ï¼‰**ï¼šæ‰€æœ‰äº¤äº’ã€UI æ–‡æœ¬ã€ä»£ç æ³¨é‡Šã€è®¾è®¡æ–‡æ¡£å¿…é¡»ä½¿ç”¨ä¸­æ–‡ã€‚
- **ç ´åæ€§å˜æ›´/æ¿€è¿›é‡æ„**ï¼šé»˜è®¤é‡‡å–ç ´åæ€§æ”¹åŠ¨å¹¶æ‹’ç»å‘åå…¼å®¹ï¼Œä¸»åŠ¨æ¸…ç†è¿‡æ—¶ä»£ç ã€æ¥å£ä¸æ–‡æ¡£ã€‚äº¤ä»˜å¿…é¡»å®Œæ•´å…·ä½“ï¼Œç¦æ­¢å ä½æˆ– `NotImplemented`ã€‚
- **æ–¹æ¡ˆå…ˆè¡Œ**ï¼šç¼–ç å‰å¿…é¡»å®Œæˆ **Sequential-Thinking** åˆ†æã€‚åœ¨å¼€å§‹ç›´æ¥æ”¹åŠ¨ä»£ç å‰ï¼Œå¿…é¡»å…ˆè¿›è¡Œæ–¹æ¡ˆåˆ†æå¹¶è·å¾—ï¼ˆæˆ–è‡ªæˆ‘ç¡®è®¤ï¼‰æ¸…æ™°çš„è·¯å¾„ã€‚
- **ï¼ˆä»…åœ¨å½“å‰æ˜¯antigravityå¹¶ä¸”ä½ æ˜¯geminiæ¨¡å‹æ—¶ï¼Œä¸æ˜¯çš„è¯å°±ä¸ç®¡è¿™æ¡ï¼‰éœ€æ±‚ç¡®è®¤å…ˆè¡Œ**ï¼šåœ¨è¿›è¡Œä»»ä½•ä»£ç ä¿®æ”¹å‰ï¼Œå¿…é¡»å…ˆä¸ç”¨æˆ·ç¡®è®¤éœ€æ±‚ã€‚ä¸¥ç¦åœ¨æœªç¡®è®¤éœ€æ±‚çš„æƒ…å†µä¸‹æ“…è‡ªè¿›è¡Œéå¿…è¦çš„é‡æ„æˆ–æ ·å¼è°ƒæ•´ã€‚
- **æ ·å¼å¼€å‘çº¦æŸï¼ˆæ ¸å¿ƒè§„å®šï¼‰**ï¼š**å½“ä»»åŠ¡ç›®æ ‡ä¸ºä¼˜åŒ–æ ·å¼/è§†è§‰æ•ˆæœæ—¶ï¼Œä¸¥ç¦ä¿®æ”¹ä»»ä½•ä¸šåŠ¡é€»è¾‘ä»£ç **ï¼ˆå¦‚çŠ¶æ€åˆ¤å®šã€Button çš„ disabled æ¡ä»¶ã€Phase è½¬æ¢é€»è¾‘ç­‰ï¼‰ã€‚å¦‚éœ€ä¿®æ”¹é€»è¾‘ï¼Œå¿…é¡»å•ç‹¬ç”³è¯·ã€‚
- **å…³é”®é€»è¾‘æ³¨é‡Šï¼ˆå¼ºåˆ¶ï¼‰**ï¼šæ¶‰åŠå…¨å±€çŠ¶æ€/æ¶æ„å…¥å£/é»˜è®¤è¡Œä¸ºï¼ˆä¾‹å¦‚ Modal æ ˆã€è·¯ç”±å®ˆå«ã€å…¨å±€äº‹ä»¶ï¼‰å¿…é¡»å†™æ¸…æ™°ä¸­æ–‡æ³¨é‡Šï¼›æäº¤å‰è‡ªæ£€æ˜¯å¦é—æ¼ï¼Œé¿å…å†æ¬¡å‘ç”Ÿã€‚
- **æ—¥å¿—ä¸éœ€è¦å¼€å…³ï¼Œè°ƒè¯•å®Œåå°†ï¼ˆå¼ºåˆ¶ï¼‰**

### 1.1 è¯æ®é“¾ä¸æ’æŸ¥è§„èŒƒï¼ˆä¿®bugæ—¶å¼ºåˆ¶ï¼‰
- **äº‹å®/æœªçŸ¥/å‡è®¾**ï¼šæå‡ºä»»ä½•æ–¹æ¡ˆ/æ’æŸ¥/è¯„å®¡ç»“è®ºå‰ï¼Œå¿…é¡»åˆ—å‡ºï¼š
  - **å·²çŸ¥äº‹å®ï¼ˆæ¥æºï¼‰**ï¼šæ¥è‡ªç”¨æˆ·æè¿°/æ—¥å¿—/æˆªå›¾/ä»£ç è·¯å¾„çš„å¯éªŒè¯äº‹å®ã€‚
  - **æœªçŸ¥ä½†å…³é”®çš„ä¿¡æ¯**ï¼šå¹¶è¯´æ˜ç¼ºå¤±ä¼šå½±å“ä»€ä¹ˆåˆ¤æ–­ã€‚
  - **å‡è®¾ï¼ˆå«éªŒè¯æ–¹æ³•ï¼‰**ï¼šå¿…é¡»æ ‡æ³¨â€œå‡è®¾ï¼šâ€ï¼Œå¹¶ç»™å‡ºå¯æ‰§è¡Œçš„éªŒè¯æ­¥éª¤ã€‚

- **ä¿® Bug è¯æ®ä¼˜å…ˆ**ï¼šè¯æ®ä¸è¶³æ—¶ä¸å¾—ç›´æ¥æ”¹ä»£ç â€œè¯•è¯•â€ï¼Œåªèƒ½ç»™å‡ºæœ€å°éªŒè¯æ­¥éª¤æˆ–ä¸´æ—¶æ—¥å¿—æ–¹æ¡ˆã€‚
- **ç¦æ­¢ç”¨â€œå¼ºåˆ¶/ç»•è¿‡â€æ©ç›–é—®é¢˜**ï¼šä¸å¾—é€šè¿‡æ”¾å¼€å®‰å…¨é™åˆ¶/æ‰©å¤§ç™½åå•/å…³é—­æ ¡éªŒ/æ— é™é‡è¯•ç­‰æ–¹å¼æ©ç›–æ ¹å› ï¼›å¿…é¡»å…ˆå®šä½åŸå› å¹¶ç»™å‡ºéªŒè¯æ­¥éª¤ã€‚ç¡®éœ€ä¸´æ—¶ç»•è¿‡æ—¶ï¼Œå¿…é¡»æ˜ç¡®æ ‡æ³¨ä¸ºä¸´æ—¶æ–¹æ¡ˆå¹¶ç»™å‡ºå›æ»š/æ¸…ç†è®¡åˆ’ã€‚
- **è¿ç»­ä¸¤æ¬¡æœªè§£å†³**ï¼šå¿…é¡»åˆ‡æ¢ä¸ºâ€œå‡è®¾åˆ—è¡¨ â†’ éªŒè¯æ–¹æ³• â†’ å¤šæ–¹æ¡ˆå¯¹æ¯”â€çš„æ’æŸ¥æ¨¡å¼ã€‚
- **ä¸´æ—¶æ—¥å¿—è§„åˆ™**ï¼šå…è®¸åœ¨æ·»åŠ ä¸´æ—¶æ—¥å¿—/ç»Ÿè®¡ç”¨äºæ’éšœï¼›ä¸å¾—å¼•å…¥é¢å¤– debug å¼€å…³ï¼ˆå¦‚ localStorage flagï¼‰æ¥æ§åˆ¶æ—¥å¿—ï¼›é—®é¢˜è§£å†³åå¿…é¡»æ¸…ç†ã€‚
- **è¾“å‡ºæ€»ç»“**ï¼šæ¯æ¬¡å›å¤æœ«å°¾å¿…é¡»åŒ…å« `## æ€»ç»“` åŒºå—ï¼Œè¦†ç›–ç›®æ ‡ã€ç»“è®ºã€ä¾æ®ã€å¯é€‰æ–¹æ¡ˆã€ä¸‹ä¸€æ­¥ã€é£é™©ã€ä¸ç¡®å®šç‚¹ã€‚

### 2. å·¥å…·é“¾ä¸è°ƒç ”è§„èŒƒ
- **æ ¸å¿ƒå·¥å…· (MCP)**ï¼š
  - **Serena MCP** (é¦–é€‰)ï¼šç”¨äºé¡¹ç›®ç´¢å¼•ã€ä»£ç æ£€ç´¢ã€å¢åˆ æ”¹æŸ¥åŠä¸Šä¸‹æ–‡ç®¡ç†ã€‚
  - **Sequential Thinking**ï¼šåˆ†æ­¥æ€è€ƒï¼Œä¿æŒé€»è¾‘ä¸¥å¯†ä¸ä¸Šä¸‹æ–‡è¿è´¯ã€‚
  - **Context7 MCP**ï¼šè·å– Boardgame.ioã€React ç­‰å®˜æ–¹åº“çš„æœ€æƒå¨æ–‡æ¡£ã€‚
- **æ£€ç´¢ä¸é™çº§**ï¼š
  - ä¼˜å…ˆä½¿ç”¨ Serena ä¸ Context7ï¼›èµ„æ–™ä¸è¶³æ—¶è°ƒç”¨ `web.run`ï¼ˆéœ€è®°å½•æ£€ç´¢å¼ä¸è®¿é—®æ—¥æœŸï¼‰ã€‚
  - é‡ç½‘ç»œé™æµï¼ˆ429/5xxï¼‰æ‰§è¡Œä¸¥æ ¼é€€é¿ï¼ˆBackoffï¼‰ç­–ç•¥ã€‚

---

## âš ï¸ é‡è¦æ•™è®­ (Golden Rules)

### React Hooks è§„åˆ™ï¼ˆå¼ºåˆ¶ï¼‰
> **ç¦æ­¢åœ¨æ¡ä»¶è¯­å¥æˆ– return ä¹‹åè°ƒç”¨ Hooks**ã€‚æ°¸è¿œå°† Hooks ç½®äºç»„ä»¶é¡¶éƒ¨ã€‚

### CSS å¸ƒå±€ä¸çˆ¶å®¹å™¨çº¦æŸï¼ˆå¼ºåˆ¶ï¼‰
> **`overflow` å±æ€§ä¼šè¢«çˆ¶çº§å®¹å™¨è¦†ç›–ï¼Œå¯¼è‡´å­ç»„ä»¶å¸ƒå±€å¤±æ•ˆ**ã€‚
- ä¿®æ”¹å¸ƒå±€å‰å¿…é¡»ä½¿ç”¨ `grep_search` æ£€æŸ¥æ‰€æœ‰çˆ¶å®¹å™¨çš„ `overflow`ã€`height` ç­‰å±æ€§ã€‚

### é®ç½©/å±‚çº§æ’æŸ¥è§„åˆ™ï¼ˆå¼ºåˆ¶ï¼‰
> **å…ˆç”¨ `elementsFromPoint` è¯æ˜â€œè°åœ¨æœ€ä¸Šå±‚â€ï¼Œå†æ”¹å±‚çº§**ï¼›Portal å¤–å±‚å®¹å™¨å¿…é¡»æ˜¾å¼ `z-index`ï¼Œå¦åˆ™ä¼šè¢«é¡µé¢æ­£ `z-index` è¦†ç›–ã€‚

### è”æœºæµ‹è¯•ä¸ç½‘ç»œ
- **WebSocket**ï¼š`vite.config.ts` ä¸­ `hmr` ä¸¥ç¦è®¾ç½®è‡ªå®šä¹‰ç«¯å£ã€‚
- **HMR é”™è¯¯**ï¼šå‡ºç° "Upgrade Required" æ—¶ï¼Œç§»é™¤ `hmr: { port: ... }` é…ç½®ã€‚
- **ç«¯å£å ç”¨**ï¼šä½¿ç”¨ `taskkill /F /IM node.exe` æ¸…ç†å ç”¨ã€‚

### é«˜é¢‘äº¤äº’è§„èŒƒ
- **Ref ä¼˜å…ˆ**ï¼š`MouseMove` ç­‰é«˜é¢‘å›è°ƒä¼˜å…ˆç”¨ `useRef` é¿å¼€ `useState` å¼‚æ­¥å»¶è¿Ÿå¯¼è‡´çš„è·³åŠ¨ã€‚
- **ç›´æ“ DOM**ï¼šå®æ—¶ UI æ›´æ–°å»ºè®®ç›´æ¥ä¿®æ”¹ `DOM.style` ç»•è¿‡ React æ¸²æŸ“é“¾ä»¥ä¼˜åŒ–æ€§èƒ½ã€‚
- **çŠ¶æ€å«ç”Ÿ**ï¼šåœ¨ `window` ç›‘å¬ `mouseup` é˜²æ­¢çŠ¶æ€å¡æ­»ï¼›é‡ç½®ä¸šåŠ¡æ—¶åŒæ­¥æ¸…ç©ºç›¸å…³ Refã€‚
- **é”šç‚¹ç®—æ³•**ï¼šå»ºç«‹ `anchorPoint` é€»è¾‘å¤„ç†åæ ‡ç¼©æ”¾ä¸å®šä½è¡¥å¿ï¼Œç¡®ä¿äº¤äº’ä¸€è‡´æ€§ã€‚

### åŠ¨ç”»/åŠ¨æ•ˆè§„èŒƒ
- **åŠ¨ç”»åº“å·²æ¥å…¥**ï¼šé¡¹ç›®ä½¿ç”¨ **framer-motion**ï¼ˆ`motion` / `AnimatePresence`ï¼‰ã€‚
- **é€šç”¨åŠ¨æ•ˆç»„ä»¶**ï¼š`src/components/common/animations/` ä¸‹å·²æœ‰ `FlyingEffect`ã€`ShakeContainer`ã€`PulseGlow` ä¸ `variants`ã€‚
- **ä¼˜å…ˆå¤ç”¨åŸåˆ™**ï¼šæ–°å¢åŠ¨ç”»ä¼˜å…ˆå¤ç”¨/æ‰©å±•ä¸Šè¿°ç»„ä»¶æˆ– framer-motion å˜ä½“ï¼Œé¿å…é‡å¤é€ è½®å­æˆ–å¼•å…¥å¹³è¡ŒåŠ¨ç”»åº“ã€‚

### æ¡†æ¶æ–‡æ¡£ç´¢å¼•
- **å‰ç«¯æ¡†æ¶å°è£…**ï¼š`docs/framework/frontend.md`
- **åç«¯æ¡†æ¶å°è£…**ï¼š`docs/framework/backend.md`

### æ–‡æ¡£ç´¢å¼•ä¸ä½¿ç”¨æ—¶æœºï¼ˆå¼ºåˆ¶ï¼‰
- **å·¥å…·è„šæœ¬æ–‡æ¡£**ï¼š`docs/tools.md`ï¼ˆæ¶‰åŠè„šæœ¬ä½¿ç”¨ã€èµ„æºå¤„ç†ã€å›¾é›†æ‰«æã€è”æœºæ¨¡æ‹Ÿæ—¶å¿…é¡»å…ˆè¯»ï¼‰
- **DiceThrone å›½é™…åŒ–è¯´æ˜**ï¼š`docs/dicethrone-i18n.md`ï¼ˆæ–°å¢/ä¿®æ”¹æ–‡æ¡ˆã€å¡ç‰Œã€çŠ¶æ€æ•ˆæœæˆ–å›¾ç‰‡æœ¬åœ°åŒ–æ—¶å¿…é¡»å…ˆè¯»ï¼‰
- **éƒ¨ç½²è¯´æ˜**ï¼š`docs/deploy.md`ï¼ˆæœ¬åœ°/çº¿ä¸Šéƒ¨ç½²ã€ç«¯å£ä¸æœåŠ¡ç¼–æ’è°ƒæ•´æ—¶å¿…é¡»å…ˆè¯»ï¼‰
- **æµ‹è¯•æ¨¡å¼è¯´æ˜**ï¼š`docs/test-mode.md`ï¼ˆéœ€è¦æµ‹è¯•å…¥å£ã€è°ƒè¯•é¢æ¿æˆ–æµ‹è¯•æµç¨‹æ—¶å¿…é¡»å…ˆè¯»ï¼‰
- **è°ƒè¯•è¿è¡Œæ‰‹å†Œ**ï¼š`docs/debugging/runbook.md`ï¼ˆçº¿ä¸Š/æœ¬åœ°æ’éšœã€é”™è¯¯å®šä½ã€æ—¥å¿—è§„èŒƒç›¸å…³æ—¶å¿…é¡»å…ˆè¯»ï¼‰
- **å‰ç«¯æ¡†æ¶å°è£…**ï¼š`docs/framework/frontend.md`ï¼ˆæ¶‰åŠå‰ç«¯æ¶æ„/å°è£…çº¦å®šæ—¶å¿…é¡»å…ˆè¯»ï¼‰
- **åç«¯æ¡†æ¶å°è£…**ï¼š`docs/framework/backend.md`ï¼ˆæ¶‰åŠåç«¯æ¶æ„/å°è£…çº¦å®šæ—¶å¿…é¡»å…ˆè¯»ï¼‰

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

| å±‚çº§ | æŠ€æœ¯ | è¯´æ˜ |
|------|------|------|
| å‰ç«¯æ¡†æ¶ | React 19 + TypeScript | å‡½æ•°å¼ç»„ä»¶ + Hooks |
| æ„å»ºå·¥å…· | Vite 7 | å¿«é€Ÿçƒ­æ›´æ–° |
| æ ·å¼æ–¹æ¡ˆ | Tailwind CSS 4 | åŸå­åŒ– CSS |
| åŠ¨ç”»/åŠ¨æ•ˆ | framer-motion | motion/AnimatePresence + é€šç”¨åŠ¨æ•ˆç»„ä»¶ |
| å›½é™…åŒ– | i18next + react-i18next | å¤šè¯­è¨€ä¸æ‡’åŠ è½½è¯æ¡ |
| éŸ³é¢‘ | howler | ç»Ÿä¸€éŸ³æ•ˆ/éŸ³ä¹ç®¡ç† |
| å®æ—¶é€šä¿¡ | socket.io-client | æ¸¸æˆå¤§å…/æˆ¿é—´å®æ—¶æ›´æ–° |
| æ¸¸æˆå¼•æ“ | Boardgame.io | çŠ¶æ€æœº + ç½‘ç»œåŒæ­¥ |
| åç«¯ | Node.js (Koa) | API æœåŠ¡ |
| æ•°æ®åº“ | MongoDB | ç”¨æˆ·/å¯¹å±€æ•°æ® |

> è¯´æ˜ï¼š`three` / `@react-three/fiber` / `@react-three/drei` å·²å®‰è£…ä½†å½“å‰æœªæ¥å…¥ä»£ç ï¼Œé¿å…åœ¨æœªç¡®è®¤éœ€æ±‚å‰å¯ç”¨ã€‚

### TypeScript ç±»å‹è§„èŒƒï¼ˆå¼ºåˆ¶ï¼‰

- **ç¦æ­¢ `any`**ï¼šæ‰€æœ‰æ–°å¢ä»£ç ç¦æ­¢ä½¿ç”¨ `any` ç±»å‹ï¼Œå¿…é¡»ä½¿ç”¨æ˜ç¡®ç±»å‹æˆ– `unknown` + ç±»å‹å®ˆå«ã€‚
- **æ¡†æ¶è¾¹ç•Œä¾‹å¤–**ï¼šä»…åœ¨ä»¥ä¸‹åœºæ™¯å…è®¸å®½æ¾ç±»å‹ï¼š
  - `src/core/types.ts` ä¸­çš„ `GameImplementation` æ¥å£ï¼ˆBoardgame.io æ³›å‹é€†å˜é™åˆ¶ï¼‰
  - ç¬¬ä¸‰æ–¹åº“ç±»å‹å®šä¹‰ä¸å®Œæ•´æ—¶ï¼Œéœ€æ·»åŠ æ³¨é‡Šè¯´æ˜åŸå› 
- **æ¸¸æˆç±»å‹å®šä¹‰**ï¼š
  - æ¸¸æˆçŠ¶æ€ç±»å‹å®šä¹‰åœ¨ `src/games/<æ¸¸æˆå>/types.ts`
  - æ¡†æ¶çº§ç±»å‹å®šä¹‰åœ¨ `src/core/types.ts`
  - é€šç”¨ç³»ç»Ÿç±»å‹å®šä¹‰åœ¨ `src/systems/`
  - ç±»å‹å®‰å…¨ç”±å„æ¸¸æˆæ¨¡å—å†…éƒ¨ (`game.ts` / `Board.tsx`) ä¿è¯
- **èµ„æºç®¡ç†**ï¼šä½¿ç”¨ `src/core/AssetLoader.ts` ç»Ÿä¸€ç®¡ç†èµ„æºè·¯å¾„

---

## ğŸ”„ æ ‡å‡†å·¥ä½œæµ

### 1. éœ€æ±‚ä¸è®¾è®¡
- **UI è®¾è®¡å·¥ä½œæµï¼ˆé™¤éæŒ‡æ˜å¦åˆ™ä¸å¼ºåˆ¶æ‰§è¡Œï¼‰**ï¼š
  1. **è§†è§‰æ‰“æ ·**ï¼šä½¿ç”¨ `generate_image` ç”Ÿæˆå¤šç§ä¸åŒé£æ ¼ã€‚
  2. **ç”¨æˆ·å†³ç­–**ï¼šå±•ç¤ºç”Ÿæˆçš„å›¾ç‰‡ï¼Œè®©ç”¨æˆ·é€‰æ‹©åå¥½çš„é£æ ¼ã€‚
  3. **è§„èŒƒè½åœ°**ï¼šåŸºäºé€‰å®šé£æ ¼å®šä¹‰é¢œè‰²å˜é‡ä¸ç»„ä»¶æ ·å¼ã€‚

### 2. éªŒè¯æµ‹è¯• (é™¤éæŒ‡æ˜å¦åˆ™ä¸å¼ºåˆ¶æ‰§è¡Œ)
- **ä¸€é”®æµç¨‹ï¼ˆæ— éœ€æŸ¥ä»£ç ï¼‰**ï¼š
  1. **ç¡®è®¤æœåŠ¡å°±ç»ª**ï¼šå‰ç«¯/æ¸¸æˆæœåŠ¡å·²å¯åŠ¨å¹¶å¯è®¿é—®ã€‚
  2. **ç›´æ¥è®¿é—®ç›®æ ‡è·¯ç”±**ï¼šç”¨ `browser_subagent` æ‰“å¼€å½“å‰ä»»åŠ¡è¦æ±‚çš„é¡µé¢ï¼ˆé»˜è®¤é¦–é¡µæˆ–éœ€æ±‚æ˜ç¡®çš„è·¯ç”±ï¼‰ã€‚
  3. **è‡ªåŠ¨åŒ–æµ‹è¯•**ï¼šç”¨åŒå±æ¨¡å¼å®Œæˆå…³é”®æµç¨‹å½•åˆ¶ä¸éªŒè¯ã€‚
  4. **æ‰‹åŠ¨éªŒè¯**ï¼šé€šè¿‡ Debug Panel åˆ‡æ¢ Player IDï¼ˆ0/1/Spectatorï¼‰èµ°é€šæ ¸å¿ƒå›åˆã€‚
  5. **æ§åˆ¶å°å®¡è®¡**ï¼šç¡®ä¿æ—  React Runtime é”™è¯¯æˆ– Hooks é¡ºåºè­¦å‘Šã€‚
- **æœ¬åœ°åŒå±å…¥å£æ¸…å•ï¼ˆå›ºå®šæµ‹è¯•é“¾æ¥ï¼‰**ï¼š
  - è·¯ç”±è§„åˆ™ï¼š`/play/:gameId/local`
  - å¯ç”¨ gameIdï¼š`tictactoe`ï¼ˆäº•å­—æ£‹ï¼‰ã€`dicethrone`ï¼ˆç‹æƒéª°é“¸ï¼‰
  - ç¤ºä¾‹ï¼š`http://127.0.0.1:5173/play/dicethrone/local`
- **å¤±è´¥å¤„ç†ï¼ˆå¼ºåˆ¶ï¼‰**ï¼šç½‘é¡µå¯¼èˆªå¤±è´¥æ—¶ï¼Œ**ç¦æ­¢é‡è¯•**ï¼Œå¿…é¡»ç«‹å³è°ƒç”¨ `read_terminal` è·å–æœåŠ¡å™¨æ—¥å¿—æˆ–æµè§ˆå™¨æ§åˆ¶å°æ—¥å¿—ã€‚

---

## ğŸ“‚ é¡¹ç›®ç›®å½•ç»“æ„

```
src/
â”œâ”€â”€ core/                    # æ¡†æ¶æ ¸å¿ƒï¼ˆä¸å…·ä½“æ¸¸æˆæ— å…³ï¼‰
â”‚   â”œâ”€â”€ types.ts             # æ¡†æ¶çº§ç±»å‹å®šä¹‰ï¼ˆGameImplementation ç­‰ï¼‰
â”‚   â”œâ”€â”€ AssetLoader.ts       # èµ„æºåŠ è½½å™¨
â”‚   â”œâ”€â”€ UndoManager.ts       # æ’¤é”€ç®¡ç†å™¨
â”‚   â””â”€â”€ index.ts             # æ¨¡å—å¯¼å‡º
â”œâ”€â”€ systems/                 # é€šç”¨æ¸¸æˆç³»ç»Ÿï¼ˆå¯å¤ç”¨äºå¤šæ¸¸æˆï¼‰
â”‚   â”œâ”€â”€ StatusEffectSystem.ts # çŠ¶æ€æ•ˆæœç³»ç»Ÿï¼ˆBuff/Debuffï¼‰
â”‚   â”œâ”€â”€ AbilitySystem.ts     # æŠ€èƒ½ç³»ç»Ÿ
â”‚   â””â”€â”€ index.ts             # æ¨¡å—å¯¼å‡º
â”œâ”€â”€ games/                   # å…·ä½“æ¸¸æˆå®ç°
â”‚   â”œâ”€â”€ manifest.ts          # æ¸¸æˆæ¸…å•ï¼ˆçº¯æ•°æ®ï¼‰
â”‚   â”œâ”€â”€ registry.ts          # å®ç°æ³¨å†Œ
â”‚   â”œâ”€â”€ tictactoe/           # äº•å­—æ£‹
â”‚   â””â”€â”€ dicethrone/          # ç‹æƒéª°é“¸
â”‚       â”œâ”€â”€ monk/            # åƒ§ä¾£è‹±é›„æ¨¡å—
â”‚       â”‚   â”œâ”€â”€ statusEffects.ts
â”‚       â”‚   â””â”€â”€ abilities.ts
â”‚       â”œâ”€â”€ types.ts
â”‚       â”œâ”€â”€ game.ts
â”‚       â””â”€â”€ Board.tsx
â”œâ”€â”€ components/              # é€šç”¨ UI ç»„ä»¶
â”œâ”€â”€ contexts/                # React Context
â”œâ”€â”€ lib/                     # é€šç”¨å·¥å…·ï¼ˆéŸ³é¢‘/i18n ç­‰ï¼‰
â”œâ”€â”€ pages/                   # é¡µé¢ç»„ä»¶
â””â”€â”€ config/                  # é…ç½®æ–‡ä»¶
```

### å…³é”®æ–‡ä»¶é€ŸæŸ¥

| ç”¨é€” | è·¯å¾„ |
|------|------|
| æ¡†æ¶æ ¸å¿ƒç±»å‹ | `src/core/types.ts` |
| çŠ¶æ€æ•ˆæœç³»ç»Ÿ | `src/systems/StatusEffectSystem.ts` |
| æŠ€èƒ½ç³»ç»Ÿ | `src/systems/AbilitySystem.ts` |
| å›½é™…åŒ–å…¥å£ | `src/lib/i18n/` |
| éŸ³é¢‘ç®¡ç†å™¨ | `src/lib/audio/AudioManager.ts` |
| æ¸¸æˆé€»è¾‘ | `src/games/<æ¸¸æˆå>/game.ts` |
| æ¸¸æˆ UI | `src/games/<æ¸¸æˆå>/Board.tsx` |
| è‹±é›„å®šä¹‰ | `src/games/<æ¸¸æˆå>/<è‹±é›„>/` |
| åº”ç”¨å…¥å£ | `src/App.tsx` |
| è¯æ®å½’æ¡£ | `evidence/` |

---

## ğŸ–¼ï¸ å›¾ç‰‡èµ„æºä¸ä½¿ç”¨è§„èŒƒ

- **èµ„æºæ ¹ç›®å½•**ï¼š`public/assets/`ï¼›å›¾ç‰‡å‹ç¼©è¾“å‡ºæ”¾åœ¨åŒçº§ `compressed/` å­ç›®å½•ã€‚
- **å‹ç¼©è„šæœ¬**ï¼š`scripts/compress_images.py` ç”Ÿæˆ `.avif/.webp`ã€‚
- **å‰ç«¯å¼•ç”¨**ï¼š
  - `<img>` ç”¨ `OptimizedImage`ã€‚
  - CSS èƒŒæ™¯ç”¨ `buildOptimizedImageSet`ã€‚
  - `src` å¯ç›´æ¥ä¼ ç›¸å¯¹è·¯å¾„ï¼ˆå¦‚ `dicethrone/images/...`ï¼‰ï¼Œå†…éƒ¨ä¼šè‡ªåŠ¨è¡¥ `/assets/` å¹¶è½¬ `.avif/.webp`ã€‚

## ğŸ”Š éŸ³é¢‘èµ„æºä¸ä½¿ç”¨è§„èŒƒ

- **èµ„æºæ ¹ç›®å½•**ï¼š`public/assets/`ï¼›éŸ³é¢‘å‹ç¼©è¾“å‡ºæ”¾åœ¨åŒçº§ `compressed/` å­ç›®å½•ã€‚
- **å‹ç¼©è„šæœ¬**ï¼š`scripts/compress_audio.js` åªç”Ÿæˆ `.ogg`ï¼ˆä¾èµ– `ffmpeg`ï¼‰ã€‚
- **å‰ç«¯å¼•ç”¨**ï¼š
  - `AudioManager` è‡ªåŠ¨è¡¥ `/assets/`ï¼Œå¯ç›´æ¥ä¼ ç›¸å¯¹è·¯å¾„ï¼ˆå¦‚ `common/audio/compressed/click.ogg`ï¼‰ã€‚

## ğŸ¨ UI/UX è§„èŒƒ (General Paradigm)

### 1. æ ¸å¿ƒå®¡ç¾å‡†åˆ™ (Visual Excellence)
- **æ·±åº¦æ„Ÿ (Depth)**ï¼šç¦æ­¢å¹³é“ºè‰²å—ã€‚é€šè¿‡æ¸å˜ã€æ¯›ç»ç’ƒ (Backdrop Blur)ã€è½¯é˜´å½± (Soft Shadow) æ„å»ºè§†è§‰å±‚çº§ã€‚
- **åŠ¨æ•ˆåé¦ˆ (Motion)**ï¼šæ‰€æœ‰çŠ¶æ€å˜æ›´ï¼ˆHover, Active, Transitionï¼‰å¿…é¡»ç”±ç‰©ç†åŠ¨æ•ˆæ”¯æ’‘ï¼Œä¼˜å…ˆå¤ç”¨é¡¹ç›®åŠ¨æ•ˆåº“ã€‚
- **å¸ƒå±€ç¨³å®šæ€§ (Layout)**ï¼šåŠ¨æ€å†…å®¹é€šè¿‡ `absolute` æˆ–é¢„ç•™ç©ºé—´å®ç°ã€‚**è¾…åŠ©æŒ‰é’®ä¸¥ç¦å æ®æ ¸å¿ƒä¸šåŠ¡æµç©ºé—´ï¼Œå¿…é¡»ä»¥æ‚¬æµ® (Overlay) æ–¹å¼è´´è¾¹/è´´åº•æ˜¾ç¤ºã€‚**

### 2. å¤šç«¯å¸ƒå±€ç­–ç•¥ (Multi-Device Layout Strategy)
- **PC æ ¸å¿ƒé©±åŠ¨ (PC-First)**ï¼šä»¥ PC ç«¯ (16:9) ä¸ºæ ¸å¿ƒè®¾è®¡åŸºå‡†ï¼Œè¿½æ±‚æè‡´çš„å¤§å±æ²‰æµ¸æ„Ÿä¸ä¸“ä¸šçº§äº¤äº’æ“ä½œã€‚
- **åœºæ™¯è‡ªé€‚åº” (Scene-Centric)**ï¼šé’ˆå¯¹æ¸¸æˆå†…æ ¸è¿›è¡Œè‡ªé€‚åº”ä¼˜åŒ–ã€‚ç§»åŠ¨ç«¯å®šä½ä¸ºâ€œå°½åŠ›å…¼å®¹ (Best-effort Compatibility)â€ï¼Œä¼˜å…ˆä¿è¯æ ¸å¿ƒåŠŸèƒ½å¯ç”¨ã€‚
- **å®½é™åº¦çº¦æŸ (Constraints)**ï¼šå¹³å°/ç½‘é¡µ UI é€šè¿‡ `max-w-7xl` ç­‰å®¹å™¨é™åˆ¶å†…å®¹å»¶å±•ï¼Œç¡®ä¿è§†è§‰ç„¦ç‚¹é›†ä¸­ã€‚
- **å¯è¯»æ€§åº•çº¿ (Readability)**ï¼šæ–‡å­—ç¦æ­¢çº¯ `vw` ç¼©æ”¾ã€‚ä½¿ç”¨ `rem` æˆ– `clamp()` è®¾å®šç‰©ç†æœ€å°å€¼ï¼ˆ12px/14pxï¼‰ï¼Œä¿éšœä»»ä½•åˆ†è¾¨ç‡ä¸‹çš„äº¤äº’å¯ç”¨æ€§ã€‚
- **æ··åˆå•ä½ç­–ç•¥ (Mixed Units)**ï¼š
    - **`vw` (Viewport Width)**ï¼š**æ ¸å¿ƒåœºæ™¯ä¸“ç”¨**ã€‚ç”¨äºæ£‹ç›˜ã€æ ¸å¿ƒå®¹å™¨ç­‰éœ€è¦éšè§†å£å®½åº¦ç­‰æ¯”ä¾‹ç¼©æ”¾çš„â€œå®ä½“â€å¯¹è±¡ï¼Œç¡®ä¿å…¶åœ¨å¤æ‚åµŒå¥—ä¸‹ä¾ç„¶ä¿æŒç»å¯¹æ¯”ä¾‹ã€‚
    - **`%` (Percentage)**ï¼š**å±€éƒ¨å¸ƒå±€ä¸“ç”¨**ã€‚ç”¨äºå®¹å™¨å†…éƒ¨çš„æ§½ä½ã€å¼¹æ€§åŒºåŸŸï¼Œç¡®ä¿å…ƒç´ ç›¸å¯¹äºçˆ¶çº§çš„æ­£ç¡®å¡«å……ã€‚
    - **`px/rem` (Fixed/Scaled)**ï¼š**UI ç»†èŠ‚ä¸“ç”¨**ã€‚ç”¨äºåœ†è§’ã€è¾¹æ¡†ã€æŠ•å½±åŠæ–‡å­—åº•çº¿ï¼Œç»´æŒå•†ä¸šçº§çš„ç»†èŠ‚ç²¾è‡´æ„Ÿã€‚

### 3. æ¸¸æˆ UI ç‰¹åŒ–èŒƒå¼ (Game-Centric Design)
- **è§†è§’è§£è€¦ (Scene vs. HUD)**ï¼š
    - **åœºæ™¯å±‚ (Scene)**ï¼šæ£‹ç›˜ã€å¡ç‰‡ç­‰æ ¸å¿ƒå®ä½“ï¼Œéœ€é€šè¿‡ `anchorPoint` å¤„ç†åæ ‡ç¼©æ”¾ï¼Œç¡®ä¿è·¨å¹³å°é€»è¾‘ä¸€è‡´æ€§ã€‚
    - **UI å±‚ (HUD)**ï¼šçŠ¶æ€ä¿¡æ¯ã€æ§åˆ¶é¢æ¿ï¼Œä»¥å›¾å±‚ (Overlay) å½¢å¼æ‚¬æµ®ï¼Œé¿å…æŒ¤å‹åœºæ™¯ç©ºé—´ã€‚
- **é«˜åº¦ç¨³å®šæ€§**ï¼šæ ¸å¿ƒæ¸¸æˆåŒºï¼ˆæ£‹ç›˜/é¢æ¿ï¼‰**å¿…é¡»**ä½¿ç”¨æ˜ç¡®é«˜åº¦çº¦æŸï¼ˆå¦‚ `h-[35vw]`ï¼‰ä»£æ›¿ `h-full`ï¼Œå½»åº•è§£è€¦çˆ¶çº§ Flex ä¾èµ–ã€‚
- **ç›¸ä½æ•æ„Ÿæ€§**ï¼šUI å¿…é¡»æ¸…æ™°åé¦ˆå½“å‰â€œæ¸¸æˆç›¸ä½â€ä¸â€œæ“ä½œæƒé™â€ï¼Œé€šè¿‡é«˜äº®åˆè§„åŠ¨ä½œ (Valid Actions) é™ä½è®¤çŸ¥è´Ÿè·ã€‚

---


---

## ğŸ“‹ æ¨¡æ¿ä¸æ¸…å•

### 1. ADR æ¨¡æ¿ (Markdown)
```markdown
# ADR-NN: <æ ‡é¢˜>
æ—¥æœŸï¼šYYYY-MM-DD | çŠ¶æ€ï¼šæè®®/é€šè¿‡
## èƒŒæ™¯ï¼š<æè¿°é—®é¢˜>
## å†³ç­–ï¼š<é€‰å®šæ–¹æ¡ˆä¸ç†ç”±>
## åæœï¼š<æ­£è´Ÿå½±å“ã€è¿ç§»æ–¹æ¡ˆ>
```

### 2. éªŒè¯æ¸…å•
- [ ] `npm run lint` & `tsc` æ— æŠ¥é”™ã€‚
- [ ] æµè§ˆå™¨æ§åˆ¶å°æ— æŠ¥é”™ï¼Œå¤šäººè§†è§’æ ¸å¿ƒæµç¨‹å®Œæ•´èµ°é€šã€‚
- [ ] å“åº”å¼å¸ƒå±€è‡ªé€‚åº”ã€‚

---

*æœ€åæ›´æ–°ï¼š2026-01-20*
